(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[279],{7653:function(e,t,l){"use strict";l.d(t,{Z:function(){return r}});var s=l(4297);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s.Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},6953:function(e,t,l){"use strict";l.d(t,{Z:function(){return r}});var s=l(4297);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s.Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},5169:function(e,t,l){"use strict";l.d(t,{Z:function(){return r}});var s=l(4297);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s.Z)("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]])},3696:function(e,t,l){"use strict";l.d(t,{Z:function(){return r}});var s=l(4297);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s.Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},3718:function(e,t,l){"use strict";l.d(t,{Z:function(){return r}});var s=l(4297);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s.Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},2620:function(e,t,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/student/profile",function(){return l(5778)}])},5778:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return StudentProfile}});var s=l(5893),r=l(7294),n=l(3022),a=l(6266),i=l(8815),d=l(4933),o=l(3756),c=l(5169),x=l(3696),u=l(1352),m=l(6953),h=l(3761),g=l(4622),f=l(9455),b=l(4464),y=l(3718),p=l(7653),j=l(6501),N=l(7066);function StudentProfile(){let{currentUser:e,userProfile:t,refreshUserProfile:l}=(0,a.a)(),[w,v]=(0,r.useState)(null),[k,Z]=(0,r.useState)(null),[_,E]=(0,r.useState)(null),[P,S]=(0,r.useState)(!1),[C,D]=(0,r.useState)(!0),[M,F]=(0,r.useState)(!1),[L,T]=(0,r.useState)(!1),[A,I]=(0,r.useState)({name:"",student_id:""});async function fetchProfileData(){try{let{data:t}=await i.T.getProfilePhoto(e.uid);t&&t.profile_photo_url&&v(t.profile_photo_url);let l=await N.Z.get("".concat("http://localhost:8000","/api/face-encodings/").concat(e.uid));l.data.success&&Z(l.data);let{data:s}=await i.T.getEnrolledImage(e.uid);s&&s.enrolled_image_url&&E(s.enrolled_image_url)}catch(e){console.error("Error fetching profile data:",e)}finally{D(!1)}}async function deleteEnrollment(){if(confirm("Are you sure you want to delete your face enrollment? This action cannot be undone."))try{F(!0);let t=await N.Z.delete("".concat("http://localhost:8000","/api/face-encodings/").concat(e.uid));t.data.success?(j.ZP.success("Face enrollment deleted successfully!"),await fetchProfileData()):j.ZP.error(t.data.message||"Failed to delete enrollment")}catch(e){console.error("Error deleting enrollment:",e),j.ZP.error("Failed to delete enrollment. Please try again.")}finally{F(!1)}}function handleEditClick(){T(!0),I({name:(null==t?void 0:t.name)||"",student_id:(null==t?void 0:t.student_id)||""})}function handleCancelEdit(){T(!1),I({name:(null==t?void 0:t.name)||"",student_id:(null==t?void 0:t.student_id)||""})}async function handleSaveProfile(){if(!A.name.trim()){j.ZP.error("Name is required");return}try{F(!0);let{data:t,error:s}=await i.T.updateUserProfile(e.uid,{name:A.name.trim(),student_id:A.student_id.trim()});if(s){j.ZP.error(s.message);return}j.ZP.success("Profile updated successfully!"),T(!1),l&&await l()}catch(e){console.error("Error updating profile:",e),j.ZP.error("Failed to update profile. Please try again.")}finally{F(!1)}}return((0,r.useEffect)(()=>{e&&fetchProfileData()},[e]),(0,r.useEffect)(()=>{t&&I({name:t.name||"",student_id:t.student_id||""})},[t]),C)?(0,s.jsx)(n.Z,{children:(0,s.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,s.jsx)("div",{className:"loading-spinner"})})}):(0,s.jsx)(n.Z,{children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto space-y-8",children:[(0,s.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl p-8 text-white",children:(0,s.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,s.jsxs)("div",{className:"relative",children:[w?(0,s.jsx)("img",{src:w,alt:"Profile",className:"w-24 h-24 rounded-full object-cover border-4 border-white/30 shadow-lg"}):(0,s.jsx)("div",{className:"w-24 h-24 rounded-full bg-white/20 flex items-center justify-center border-4 border-white/30",children:(0,s.jsx)(d.Z,{className:"h-12 w-12 text-white/80"})}),(null==k?void 0:k.enrolled)&&(0,s.jsx)("div",{className:"absolute -bottom-2 -right-2 w-8 h-8 bg-green-500 rounded-full flex items-center justify-center border-2 border-white",children:(0,s.jsx)(o.Z,{className:"h-4 w-4 text-white"})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-4xl font-bold mb-2",children:"Student Profile"}),(0,s.jsx)("p",{className:"text-blue-100 text-lg",children:"Manage your profile and face enrollment"})]})]})}),(0,s.jsxs)("div",{className:"bg-white rounded-2xl p-8 shadow-lg border border-gray-100",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsxs)("h2",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[(0,s.jsx)(d.Z,{className:"h-6 w-6 text-blue-600 mr-3"}),"Profile Information"]}),L?(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsxs)("button",{onClick:handleSaveProfile,disabled:M,className:"flex items-center px-4 py-2 text-green-600 hover:text-green-700 hover:bg-green-50 rounded-lg transition-colors border border-green-200 disabled:opacity-50",children:[(0,s.jsx)(x.Z,{className:"h-4 w-4 mr-2"}),M?"Saving...":"Save"]}),(0,s.jsxs)("button",{onClick:handleCancelEdit,disabled:M,className:"flex items-center px-4 py-2 text-gray-600 hover:text-gray-700 hover:bg-gray-50 rounded-lg transition-colors border border-gray-200 disabled:opacity-50",children:[(0,s.jsx)(u.Z,{className:"h-4 w-4 mr-2"}),"Cancel"]})]}):(0,s.jsxs)("button",{onClick:handleEditClick,className:"flex items-center px-4 py-2 text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded-lg transition-colors border border-blue-200",children:[(0,s.jsx)(c.Z,{className:"h-4 w-4 mr-2"}),"Edit Profile"]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3 p-4 bg-gray-50 rounded-lg",children:[(0,s.jsx)(d.Z,{className:"h-5 w-5 text-gray-600"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Full Name"}),L?(0,s.jsx)("input",{type:"text",value:A.name,onChange:e=>I({...A,name:e.target.value}),className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter your full name"}):(0,s.jsx)("p",{className:"text-lg font-semibold text-gray-900",children:null==t?void 0:t.name})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-3 p-4 bg-gray-50 rounded-lg",children:[(0,s.jsx)(m.Z,{className:"h-5 w-5 text-gray-600"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Email Address"}),(0,s.jsx)("p",{className:"text-lg font-semibold text-gray-900",children:null==t?void 0:t.email}),L&&(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Email cannot be changed"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3 p-4 bg-gray-50 rounded-lg",children:[(0,s.jsx)(h.Z,{className:"h-5 w-5 text-gray-600"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Student ID"}),L?(0,s.jsx)("input",{type:"text",value:A.student_id,onChange:e=>I({...A,student_id:e.target.value}),className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter your student ID"}):(0,s.jsx)("p",{className:"text-lg font-semibold text-gray-900",children:(null==t?void 0:t.student_id)||"Not assigned"})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-3 p-4 bg-gray-50 rounded-lg",children:[(0,s.jsx)(g.Z,{className:"h-5 w-5 text-gray-600"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Member Since"}),(0,s.jsx)("p",{className:"text-lg font-semibold text-gray-900",children:(null==t?void 0:t.created_at)?new Date(t.created_at).toLocaleDateString():"N/A"})]})]})]})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-2xl p-8 shadow-lg border border-gray-100",children:[(0,s.jsxs)("h2",{className:"text-2xl font-bold text-gray-900 mb-6 flex items-center",children:[(0,s.jsx)(f.Z,{className:"h-6 w-6 text-blue-600 mr-3"}),"Face Enrollment Status"]}),(null==k?void 0:k.enrolled)?(0,s.jsx)("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-xl p-6",children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"w-12 h-12 bg-green-500 rounded-full flex items-center justify-center mr-4",children:(0,s.jsx)(o.Z,{className:"h-6 w-6 text-white"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-green-800 mb-1",children:"Face Successfully Enrolled"}),(0,s.jsxs)("p",{className:"text-green-600",children:["Enrolled on ",new Date(k.enrolled_at).toLocaleDateString()]}),(0,s.jsx)("p",{className:"text-sm text-green-600 mt-1",children:"You can now mark attendance using face recognition"})]})]}),w&&(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("img",{src:w,alt:"Enrolled face",className:"w-16 h-16 rounded-full object-cover border-2 border-green-300 shadow-lg"}),(0,s.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,s.jsxs)("button",{onClick:()=>S(!0),className:"flex items-center px-4 py-2 text-sm text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded-lg transition-colors border border-blue-200",children:[(0,s.jsx)(b.Z,{className:"h-4 w-4 mr-2"}),"View Image"]}),(0,s.jsxs)("button",{onClick:deleteEnrollment,disabled:M,className:"flex items-center px-4 py-2 text-sm text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50 border border-red-200",children:[(0,s.jsx)(y.Z,{className:"h-4 w-4 mr-2"}),M?"Deleting...":"Delete"]})]})]})]})}):(0,s.jsx)("div",{className:"bg-gradient-to-r from-yellow-50 to-orange-50 border border-yellow-200 rounded-xl p-6",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"w-12 h-12 bg-yellow-500 rounded-full flex items-center justify-center mr-4",children:(0,s.jsx)(p.Z,{className:"h-6 w-6 text-white"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-yellow-800 mb-1",children:"No Face Enrolled"}),(0,s.jsx)("p",{className:"text-yellow-600 mb-3",children:"You need to enroll your face to mark attendance using face recognition"}),(0,s.jsx)("button",{onClick:()=>window.location.href="/student/enroll",className:"bg-yellow-600 hover:bg-yellow-700 text-white font-medium py-2 px-4 rounded-lg transition-colors",children:"Enroll Your Face"})]})]})})]}),(0,s.jsxs)("div",{className:"bg-white rounded-2xl p-8 shadow-lg border border-gray-100",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Quick Actions"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsxs)("button",{onClick:()=>window.location.href="/student/attendance",className:"flex items-center justify-center p-4 bg-blue-50 hover:bg-blue-100 text-blue-700 rounded-lg transition-colors border border-blue-200",children:[(0,s.jsx)(o.Z,{className:"h-5 w-5 mr-2"}),"Mark Attendance"]}),(0,s.jsxs)("button",{onClick:()=>window.location.href="/student/history",className:"flex items-center justify-center p-4 bg-green-50 hover:bg-green-100 text-green-700 rounded-lg transition-colors border border-green-200",children:[(0,s.jsx)(g.Z,{className:"h-5 w-5 mr-2"}),"View History"]}),(0,s.jsxs)("button",{onClick:()=>window.location.href="/student/enroll",className:"flex items-center justify-center p-4 bg-purple-50 hover:bg-purple-100 text-purple-700 rounded-lg transition-colors border border-purple-200",children:[(0,s.jsx)(f.Z,{className:"h-5 w-5 mr-2"}),"Manage Enrollment"]})]})]}),P&&_&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-2xl p-6 max-w-md w-full",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Enrolled Face Image"}),(0,s.jsx)("button",{onClick:()=>S(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,s.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("img",{src:_,alt:"Enrolled face",className:"w-full max-w-sm mx-auto rounded-lg shadow-lg"}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 mt-4",children:["Enrolled on ",(null==k?void 0:k.enrolled_at)?new Date(k.enrolled_at).toLocaleDateString():"Unknown"]})]})]})})]})})}}},function(e){e.O(0,[701,4,22,774,888,179],function(){return e(e.s=2620)}),_N_E=e.O()}]);